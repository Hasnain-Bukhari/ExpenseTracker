import{d as I,r as t,a as K,c as z,x as L,o as U,b as v,w as o,l as B,j as r,f as a,h as u,i as n,e as y,t as A,n as F,k as S,p as M,q as m,y as Y}from"./index-DbIPzh87.js";import{_ as Z}from"./AuthCard.vue_vue_type_script_setup_true_lang-CsnN6An9.js";import{_ as h}from"./PasswordField.vue_vue_type_script_setup_true_lang-CFmK6Yik.js";const j={key:0,class:"success-state text-center"},D={class:"success-icon mb-4"},W={key:1},G={class:"d-flex flex-column"},H={class:"text-center"},ee=I({__name:"ResetPasswordView",setup(J){const q=L();M();const $=t(),s=K({newPassword:"",confirmPassword:""}),l=t(!1),_=t(!1),d=t(""),i=t(""),w=t(""),p=t(!0),P=z(()=>q.query.token),g=()=>{i.value="",s.newPassword?s.newPassword.length<8?i.value="Password must be at least 8 characters":/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(s.newPassword)||(i.value="Password must contain uppercase, lowercase, and number"):i.value="Password is required",s.confirmPassword&&b()},b=()=>{w.value="",s.confirmPassword?s.newPassword!==s.confirmPassword&&(w.value="Passwords do not match"):w.value="Please confirm your password"},x=z(()=>s.newPassword&&s.newPassword.length>=8&&/(?=.*[a-z])(?=.*[A-Z])(?=.*\d)/.test(s.newPassword)&&s.newPassword===s.confirmPassword&&!i.value&&!w.value),k=async()=>{if(g(),b(),!!x.value){l.value=!0,d.value="";try{const c=await Y({token:P.value,newPassword:s.newPassword,confirmPassword:s.confirmPassword});c.ok?_.value=!0:d.value=c.error||"Failed to reset password"}catch{d.value="Network error occurred"}finally{l.value=!1}}};return U(()=>{(!P.value||!P.value.startsWith("reset_"))&&(p.value=!1)}),(c,e)=>{const V=u("v-icon"),E=u("v-avatar"),R=u("v-btn"),C=u("v-alert"),N=u("router-link"),T=u("v-form");return m(),v(Z,{title:"Set New Password",subtitle:"Create a strong password for your account","max-width":400},{default:o(()=>[_.value?(m(),B("div",j,[r("div",D,[a(E,{size:"64",color:"success",class:"mb-4"},{default:o(()=>[a(V,{size:"32",color:"white"},{default:o(()=>[...e[4]||(e[4]=[n("mdi-check-circle",-1)])]),_:1})]),_:1})]),e[6]||(e[6]=r("h3",{class:"text-h6 mb-3"},"Password Reset Successful",-1)),e[7]||(e[7]=r("p",{class:"text-body-2 text-medium-emphasis mb-6"}," Your password has been successfully updated. You can now sign in with your new password. ",-1)),a(R,{color:"primary",variant:"elevated",block:"",size:"large",onClick:e[0]||(e[0]=f=>c.$router.push("/auth/login"))},{default:o(()=>[...e[5]||(e[5]=[n(" Continue to Sign In ",-1)])]),_:1})])):(m(),B("div",W,[d.value?(m(),v(C,{key:0,type:"error",variant:"tonal",class:"mb-6",closable:"","onClick:close":e[1]||(e[1]=f=>d.value="")},{default:o(()=>[n(A(d.value),1)]),_:1})):y("",!0),p.value?y("",!0):(m(),v(C,{key:1,type:"warning",variant:"tonal",class:"mb-6"},{default:o(()=>[r("div",G,[e[9]||(e[9]=r("strong",{class:"mb-2"},"Invalid or Expired Reset Link",-1)),e[10]||(e[10]=r("span",{class:"text-body-2"}," This password reset link is invalid or has expired. Please request a new one. ",-1)),a(N,{to:"/auth/forgot-password",class:"text-primary text-decoration-none mt-2"},{default:o(()=>[...e[8]||(e[8]=[n(" Request New Reset Link ",-1)])]),_:1})])]),_:1})),p.value?(m(),v(T,{key:2,ref_key:"formRef",ref:$,onSubmit:F(k,["prevent"]),class:"reset-password-form"},{default:o(()=>[a(h,{modelValue:s.newPassword,"onUpdate:modelValue":e[2]||(e[2]=f=>s.newPassword=f),label:"New password","prepend-inner-icon":"mdi-lock-outline","error-messages":i.value,disabled:l.value,"show-strength-meter":!0,class:"mb-4",autocomplete:"new-password",onBlur:g,onKeydown:S(k,["enter"])},null,8,["modelValue","error-messages","disabled"]),a(h,{modelValue:s.confirmPassword,"onUpdate:modelValue":e[3]||(e[3]=f=>s.confirmPassword=f),label:"Confirm new password","prepend-inner-icon":"mdi-lock-check-outline","error-messages":w.value,disabled:l.value,class:"mb-6",autocomplete:"new-password",onBlur:b,onKeydown:S(k,["enter"])},null,8,["modelValue","error-messages","disabled"]),a(R,{type:"submit",color:"primary",size:"large",block:"",variant:"elevated",loading:l.value,disabled:!x.value||l.value,class:"mb-4 submit-btn"},{default:o(()=>[...e[11]||(e[11]=[n(" Update Password ",-1)])]),_:1},8,["loading","disabled"]),r("div",H,[a(N,{to:"/auth/login",class:"text-primary text-decoration-none d-inline-flex align-center"},{default:o(()=>[a(V,{size:"18",class:"mr-1"},{default:o(()=>[...e[12]||(e[12]=[n("mdi-arrow-left",-1)])]),_:1}),e[13]||(e[13]=n(" Back to Sign In ",-1))]),_:1})])]),_:1},512)):y("",!0)]))]),_:1})}}});export{ee as default};
